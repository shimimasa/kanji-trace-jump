# Kanji Trace Jump（仮） GOD.md（最新版）

## 0. このプロジェクトの核（GOD）
- 小学生が「正しくなぞれた！」を体感できる。
- 迷わないUI（説明が短い / ボタンが少ない / 進行が自然）
- 成功=気持ちいい、失敗=怖くない（すぐ再挑戦できる）

> ※先生モードは一旦ストップ。まず子どもモードを完成させる。


---

## 1. 現状（2026-01-07時点）
### 動いている
- `main.js` で strokeデータからSVGを生成し、`#kanjiArea` に表示
- pointer入力でなぞり点を収集し、`judgeTrace()` で判定
- 画ごとの進行（activeStroke / doneStrokes）を管理
- UI枠（星/目標/タイトル/画ボタン/前へ/つぎ/説明/エラー）あり

### いまの課題（子ども視点）
- 「何をすればいいか」がUIだけでは一瞬迷う可能性
- 画ボタンや前へ/つぎの意味がブレると、誤操作で詰む
- 成功/失敗時のメッセージが固定だと、学習が進みにくい


---

## 2. 子どもモードの仕様（確定方針）
### UI方針
- 画の進行は基本「自動」
- 子どもが押すボタンは最小限（迷いを消す）
- 説明文は状況で短く切り替える（長文禁止）

### “つぎ” の意味
- 「次の画」ではなく「次の文字/次の問題」へ（※画は自動で進む）
- スキップが必要なら、先生用に後で別導線を作る（今は作らない）

### 画ボタン（1,2,3...）
- 子どもモードでは “表示だけ” が基本（押させない）
- 残す場合も、未来の画は触れない（±1のみ）などで事故防止


---

## 3. 判定（こどもがクリアできる）
### 判定要素
- 始点が近い（START_TOL）
- 線に乗れている（MIN_HIT_RATE）
- 描いた長さが極端に短くない（MIN_DRAW_LEN_RATE）
- 許容距離（TOLERANCE_PX）を中心に「ゆるさ」を調整

### 方針
- まずは“成功しやすい”を優先
- 難しさは後で上げられる（最初から厳しくしない）

### こどもプリセット（やること）
- 判定定数を “ChildPreset / StrictPreset” として切替可能にする
  - Child: 許容距離広め、ヒット率低めでもOK、始点許容も広め
  - Strict: 先生モード等で後から使用


---

## 4. 演出（最小で効くもの）
### 成功時
- 小さくキラ（短い）
- SE 1回
- メッセージ「できた！」

### 失敗時
- 赤フラッシュは弱め
- メッセージ「もういちど（ゆっくりでOK）」
- 操作不要で即復帰（詰みを作らない）

### 最終クリア
- はなまる（ドン）
- 星も同時に小さくキラ（連動）
- “終わった感” を必ず出す（ここが報酬）


---

## 5. 次の実装タスク（最短ルート）
### A. 子どもモードUI最終整理（最優先）
1) 説明文を状態で切り替え（開始/なぞり中/成功/失敗）
2) 画ボタンを「表示だけ」に固定（または未来を押せない制限）
3) 前へ/つぎの意味を固定（つぎ=次の文字、画は自動）
4) 誤操作で詰まないように disable 条件を整理

### B. 気持ちよさの最低限
5) 成功キラ + SE（短い）
6) 失敗の伝達は “落下感/軽いフラッシュ” で（怖くしない）

### C. 最終クリア
7) はなまる + 星キラ（連動）
8) ゴール演出のあと、自然に次へ行かない（メニュー/結果表示へ）


---

## 6. 後回し（今はやらない）
- teacherMode（UI/判定/操作の分岐）
- 複数セット管理の本格UI
- SVG外部ロード（ki.svg 等）への切替
- キャラレイヤーの本格実装（今は子どもUI優先）
