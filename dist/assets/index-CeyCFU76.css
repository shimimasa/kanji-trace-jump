:root{--bg: #f3f7f8;--text: #111;--muted: #7a7a7a;--line: #dfe6e8;--btn: #e9eef0;--btn2: #f6f8f9;--baseStroke: rgba(0, 0, 0, .18);--doneStroke: rgba(0, 0, 0, .35);--activeStroke: rgba(0, 0, 0, .55)}*{box-sizing:border-box}html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Hiragino Kaku Gothic ProN,Hiragino Sans,Noto Sans JP,Yu Gothic,Meiryo,sans-serif;overflow:hidden}#app{height:100%;display:flex;flex-direction:column}.hud{height:56px;display:flex;align-items:center;justify-content:space-between;padding:10px 18px}.stars{font-size:28px;letter-spacing:4px;-webkit-user-select:none;user-select:none;position:relative;display:inline-block}.starsSparkle{animation:starsPop .42s ease-out}@keyframes starsPop{0%{transform:scale(1)}35%{transform:scale(1.12)}to{transform:scale(1)}}.star-spark{position:absolute;width:6px;height:6px;border-radius:999px;background:#000000d9;pointer-events:none;animation:starSparkFly .42s ease-out forwards}@keyframes starSparkFly{0%{transform:translate(0) scale(1);opacity:.95}to{transform:translate(var(--dx),var(--dy)) scale(.2);opacity:0}}.goal{font-size:28px;font-weight:700;-webkit-user-select:none;user-select:none}.main{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:10px 16px 18px;gap:12px}.topline{margin-top:6px}.title{font-size:30px;font-weight:700;-webkit-user-select:none;user-select:none;text-align:center}.stage{width:min(720px,92vw);height:min(520px,58vh);display:grid;place-items:center;padding-bottom:18px}.kanji-area{width:min(520px,84vw);height:min(360px,42vh);display:grid;place-items:center;overflow:hidden;border-radius:16px}.kanji-area svg{width:100%;height:100%;display:block;-webkit-user-select:none;user-select:none;touch-action:none;overflow:hidden}.stroke-ui{display:flex;justify-content:center;align-items:center;min-height:52px;margin-top:6px}.stroke-buttons{display:flex;gap:14px;padding-bottom:4px}.stroke-btn{width:46px;height:46px;border-radius:999px;border:1px solid var(--line);background:#fff;box-shadow:0 8px 18px #0000000f;font-size:18px;font-weight:700;cursor:pointer;-webkit-user-select:none;user-select:none}.stroke-btn.is-done{background:#f5f7f8;color:#444}.stroke-btn.is-active{outline:3px solid rgba(0,0,0,.08)}.nav{display:flex;gap:18px;margin-top:4px;padding-top:6px}.btn{min-width:140px;height:64px;border-radius:18px;border:1px solid var(--line);background:var(--btn);font-size:22px;font-weight:700;cursor:pointer}.btn.primary{background:var(--btn2)}.btn:disabled{opacity:.5;cursor:not-allowed}.caption{margin:0;font-size:18px;color:#111;-webkit-user-select:none;user-select:none}.error{margin:0;font-size:14px;color:#b00020;min-height:20px}.stroke-hint-dot{fill:var(--ink, #111);stroke:#fff;stroke-width:6}.stroke-hint-num{font-size:42px;font-weight:800;fill:var(--ink, #111);paint-order:stroke;stroke:#fff;stroke-width:8;stroke-linejoin:round}.teacher-overlay{display:none}.teacher-mode .teacher-overlay{display:block}#teacherToggle{padding:10px 16px;border-radius:999px;border:2px solid rgba(0,0,0,.65);background:#fffffff5;font-weight:800;cursor:pointer;box-shadow:0 10px 30px #00000014}#teacherToggle,#plusBtn{display:none}.teacher-mode #teacherToggle,.teacher-mode #plusBtn{display:inline-flex}#strokeButtons,#navButtons{display:none}.teacher-mode #strokeButtons,.teacher-mode #navButtons{display:flex}.kanjiSvg{overflow:visible}.stroke-base{fill:none;stroke:var(--baseStroke);stroke-width:9;stroke-linecap:round;stroke-linejoin:round;vector-effect:non-scaling-stroke}.stroke-base.done{stroke:var(--doneStroke)}.stroke-active{fill:none;stroke:var(--activeStroke);stroke-width:12;stroke-linecap:round;stroke-linejoin:round;vector-effect:non-scaling-stroke;opacity:.9}.stroke-hit{fill:none;stroke:#0000;stroke-width:26;stroke-linecap:round;stroke-linejoin:round;pointer-events:stroke;vector-effect:non-scaling-stroke}.trace-line{fill:none;stroke:#000000e6;stroke-width:10;stroke-linecap:round;stroke-linejoin:round;vector-effect:non-scaling-stroke}.tracePulse{animation:tracePulse .22s ease-out}@keyframes tracePulse{0%{transform:scale(1);filter:drop-shadow(0 0 0 rgba(0,0,0,0))}60%{transform:scale(1.01);filter:drop-shadow(0 6px 10px rgba(0,0,0,.08))}to{transform:scale(1);filter:drop-shadow(0 0 0 rgba(0,0,0,0))}}.stroke-shadow{fill:none;stroke:#0000002e;stroke-width:12;stroke-linecap:round;stroke-linejoin:round;opacity:0;filter:blur(1.2px);pointer-events:none;transition:opacity .26s ease-out}.stroke-ui,.nav{display:none}.teacher-mode .stroke-ui,.teacher-mode .nav{display:flex}.teacher-mode .stroke-ui{display:block}.stroke-shadow.goal{stroke:#00000047;stroke-width:14;filter:blur(1.4px);transition:stroke .2s ease-out,stroke-width .2s ease-out}.stroke-shadow.pop{animation:shadowPop .26s ease-out}@keyframes shadowPop{0%{opacity:0}60%{opacity:1}to{opacity:1}}.fx-layer,.char-layer{pointer-events:none}.char{fill:#000000e6;stroke:#ffffffe6;stroke-width:1.2;filter:drop-shadow(0 3px 6px rgba(0,0,0,.18))}.fx-spark{fill:#000c}.kanjiSvg.failFlash{filter:drop-shadow(0 0 0 rgba(255,0,0,0))}.kanjiSvg.failFlash .stroke-active{stroke:#ff787873}.kanjiSvg.failFlash{filter:drop-shadow(0 2px 6px rgba(0,0,0,.1))}.traceShake{animation:traceShake .35s ease-out}@keyframes traceShake{0%{transform:translate(0)}25%{transform:translate(-2px)}50%{transform:translate(2px)}75%{transform:translate(-1px)}to{transform:translate(0)}}.traceShake{animation:traceShake .22s ease-out}.hanamaru{pointer-events:none}.hanamaru circle{stroke:#ff7a00;stroke-width:6;fill:none;animation:hanamaru-pulse 1.2s infinite}.hanamaru text{font-size:18px;font-weight:700;fill:#ff7a00}.final-overlay{position:fixed;top:0;right:0;bottom:0;left:0;display:grid;place-items:center;background:#0000002e;z-index:9999}.final-card{width:min(420px,92vw);background:#fff;border-radius:18px;padding:18px 16px;box-shadow:0 12px 28px #0000002e;text-align:center}.final-title{font-size:20px;font-weight:800;margin-bottom:12px}.final-actions{display:flex;gap:12px;justify-content:center}.stroke-hint-layer{pointer-events:none}.stroke-hint-dot{fill:#111;stroke:#fff;stroke-width:4;opacity:.95}.stroke-hint-num{font-size:28px;font-weight:800;fill:#111;paint-order:stroke;stroke:#fff;stroke-width:6}.stroke-shadow{opacity:0;transition:opacity .18s ease-out}.stroke-shadow.on{opacity:1}.stroke-shadow.pop{animation:roadPop .22s ease-out}@keyframes roadPop{0%{opacity:0}60%{opacity:1}to{opacity:1}}
